<h1>2장 스프링 부트로 마이크로서비스 구축</h1>
<ul>
  <li>2.1 아키텍트의 이야기: 마이크로서비스 아키텍처 설계</li>
  <li>2.2 마이크로서비스를 사용하지 않아야 할 때</li>
  <li>2.3 개발자 이야기: 스프링 부트와 자바로 마이크로서비스 생성</li>
  <li>2.4 데브옵스 이야기: 혹독한 런타임 구축</li>
  <li>2.5 모든 관점에서</li>
</ul>

매머드급 프로젝트는 모든 애플리케이션의 요구 사항과 설계를 프로젝트 초반에 정의할 것을 주장하는 전통적인 대규모 폭포수(waterfall) 개발 방법론을 따르는 경향이 있었다.
소프트웨어의 모든 명세가 철두철미하길 지나치게 강조한 나머지 새로운 비즈니스 요구 사항을 충족하거나 리팩토링할 여지나 개발 토기 단계에서 저지른 실수에서 배울 여유가 없었다.

전통적인 폭포수 개발 방법론을 사용하기 어려워진 것은 이들 프로젝트의 소프트웨어 산출물이 가진 세분화 정도에 따라 다음과 같은 단점이 발생할 것이다.

- 강한 결합(tightly coupled) : 비즈니스 로직 호출은 SOAP나 REST 같은 구현 기술에 중립적인 프로토콜 수준이 아닌 프로그래밍 언어 수준에서 이루어진 것이다. 
따라서 애플리케이션 컴포넌트를 조금만 수정해도 그 애플리케이션의 다른 부분을 꺠뜨리거나 새로운 버그를 생산할 가능성이 매우 높다.
- 누설(leaky) : 대규모 소프트웨어 애플리케이션의 대부분은 다양한 유형의 데이터를 취급한다. 전통적인 모델에서 데이터는 같은 데이터 저장소 안에서 같은 데이터 모델을 유지한다.
데이터 사이에 명확한 경계가 있지만 한 영역에 속한 팀이 다른 팀의 데이터에 직접적으로 접근하고 싶은 유혹을 너무 자주 받는다. 그래서 다른 영역의 데이터에 쉽게 접근하게 되면,
보이지 않는 의존성이 생겨나고 컴포넌트의 내부 데이터 구조에 대한 구현이 애플리케이션 전체에 유출이 될 수 있다. 그리고 테이블 하나를 조금만 변경해도 애플리케이션 전번에 걸처 엄청난
코드 수정과 회귀 테스팅이 필요할 수 있다.
- 모놀리식 : 전통적인 애플리케이션에서 대부분의 컴포넌트는 여러 팀에서 공유되는 단일 코드 베이스에 저장하므로 코드를 변경할 때마다 전체 애플리케이션을 재컴파일하고, 전체 테스팅 주기를
재수행하며 재배포한다.애플리케이션 코드 베이스를 조금만 변경해도 비용이 많이 들며 오랜 시간이 소요된다.

마이크로서비스 기반 아키텍처는 기능을 제공하는 데 위와 다른 접근법을 취한다. 구체적인 특성은 다름와 같다.
- 제한(constrained) : 마이크로서비스는 하나의 책임 집합을 가지며 범위가 좁다.
- 느슨한 결합(looselu coupled) : 마이크로서비스 기반 애플리케이션은 작은 버시스 집합이며, HTTP와 REST처럼 비독점적 호출 프로토콜을 사용하는 구현 기술에 중립적인 인터페이스로 서로 소통한다.
서비스에 대한 인터페이스가 변하지 않는 한 마이크로서비스 소유자는 전통적인 애플리케이션 아키텍처보다 서비스를 더 자유롭게 수정할 수 있다.
- 추상화(abstract) : 마이크로서비스는 자신의 데이터 구조와 데이터 소스를 완전히 소유한다. 마이크로서비스가 소유한 데이터는 해당 서비스만 수정할 수 있다.
- 독립적(independent) : 마이크로서비스 애플리케이션 안의 모든 마이크로서비스는 서로 독립적으로 컴파일하고 배포할 수 있다. 모놀리식 애플리케이션보다 변경 사항을 휠씬 쉽게 분리하고 테스트할
수 있는 것을 의미한다.

클라우드에 기반을 둔 개발에 왜 이러한 마이크로서비스 아키텍처의 일반적인 특징은 다음과 같이 3가지다.
- 사용자층이 다양하며 대규모다. : 마이크로서비스는 작은 범위를 담당하고, 명확히 정의된 인터페이스를 통해 접근하므로 기능을 신속히 제공할 수 있다.
- 상당한 작동 시간이 요구된다 : 마이크로서비스 자체의 분산적 특성 떄문에 애플리케이션 전체를 중단하지 않고도 고장과 문제를 더 쉽게 격리할 수 있다.
- 볼륨이 균일하지 않다 : 독립적인 배포가 가능한 작은 컴포넌트로 분리되어 있기 때문에 부하를 받는 컴포넌트를 조명하고 여러 서버에 수평 확장하기도 휠씬 쉽다.

<h2>2.1 아키텍처의 이야기 : 마이크로서비스 아키텍처 설계</h2>
마이크로서비스 아키텍처를 구축할 떄 프로젝트의 아키텍트는 다음 3가지 일에 집중한다.
1. 비즈니스 문제의 분해
2. 서비스 세분화의 확정
3. 서비스 인터페이스의 정의

<h3>비즈니스 문제의 분해</h3>

마이크로서비스 아키텍처에서 아키텍트는 비즈니스 문제를 각 화동 영역에 대표하는 덩이들로 분해하고 비즈니스 영역의 특정 부분과 연관된 비즈니스 규칙과 데이터 로직을 이 덩이들 안에 
캡슐화한다.

하지만, 항상 실현 가능한 것이 아니다. 한 트랜잭션 전체를 완료하지 위해 비즈니스 영역의 다양한 부분과 동작하는 마이크로서비스가 필요한 상황을 자주 겪는다.
아키텍트는 데이터 영역이 서로 어울리지 않는다면 마이크로서비스들의 서비스 경계를 나눈다.

마이크로서비스 후보로 분해하는 데 다음 지침을 사용하기 추천한다.
1. 비즈니스 문제를 기술하고 그 문제를 기술하는 데 사용한 명사를 주목하라.
  - 즉, 문제를 기술하는 데 동일한 명사가 반복해서 사용되면 대개 핵심 비즈니스 영역과 마이크로서비스로 만들 기회가 드러난다.
2. 동사에 주목하라
  - 동사는 행위를 부각하고 문제가 되는 영역의 윤곽을 자연스럽게 드러낸다.
3. 데이터 응집성을 찾아라.
   - 비즈니스 문제를 각 부분으로 분해할 떄 서로 연관성이 높은 데이터 부분들을 찾는다.

먼저 EagleEye는 애플리케이션의 모든 사용자를 인터뷰하고 EagleEye와 상호 작용하고 사용하는 방법을 논의할 것이다.
사용자가 어떻게 애플리케이션과 상호 작용하고 어떻게 애플리키에시녀의 데이터 모델이 분해되는지 살펴보면서 문제 영역을 다음과 같은 마이크로서비스 후보로 나눌 수 있다.



